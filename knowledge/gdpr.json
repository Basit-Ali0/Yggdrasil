{
  "policy_id": "GDPR-001",
  "policy_name": "GDPR Compliance Pack",
  "provider": "Yggdrasil",
  "description": "Complete GDPR compliance rules for automatic database scanning. Covers right to erasure, encryption, consent, retention, and PII protection.",
  "regulation": "GDPR",
  "version": "1.0",
  "rule_count": 10,
  "rules": [
    {
      "rule_id": "GDPR-001",
      "type": "retention",
      "description": "Personal data must not be retained beyond necessary period - checks for expired data retention",
      "severity": "high",
      "conditions": {
        "field": "created_at",
        "operator": "exists"
      },
      "remediation": "Implement automated data purge for records exceeding retention period defined in your data retention policy"
    },
    {
      "rule_id": "GDPR-002",
      "type": "consent",
      "description": "Processing requires valid consent - checks for consent records with missing or expired consent",
      "severity": "high",
      "conditions": {
        "field": "consent_status",
        "operator": "equals",
        "value": "pending"
      },
      "remediation": "Obtain valid consent from data subjects before processing their personal data"
    },
    {
      "rule_id": "GDPR-003",
      "type": "encryption",
      "description": "Personal data must be encrypted at rest - checks for unencrypted PII fields",
      "severity": "high",
      "conditions": {
        "field": "encrypted",
        "operator": "equals",
        "value": false
      },
      "remediation": "Enable encryption at rest for all tables containing personal data"
    },
    {
      "rule_id": "GDPR-004",
      "type": "prohibited",
      "description": "Special category data (health, biometrics) requires explicit consent and additional protections",
      "severity": "high",
      "conditions": {
        "field": "data_category",
        "operator": "contains",
        "value": "special_category"
      },
      "remediation": "Ensure explicit consent is obtained and additional security measures are in place for special category data"
    },
    {
      "rule_id": "GDPR-005",
      "type": "access",
      "description": "Data subjects have right to access their data - checks for accessibility of personal data",
      "severity": "medium",
      "conditions": {
        "field": "is_retrievable",
        "operator": "equals",
        "value": false
      },
      "remediation": "Implement data subject access request (DSAR) functionality"
    },
    {
      "rule_id": "GDPR-006",
      "type": "retention",
      "description": "Check for records marked for deletion but not yet erased (right to be forgotten)",
      "severity": "high",
      "conditions": {
        "field": "deletion_requested",
        "operator": "equals",
        "value": true
      },
      "remediation": "Permanently erase personal data within 30 days of deletion request"
    },
    {
      "rule_id": "GDPR-007",
      "type": "consent",
      "description": "Children's data requires parental consent for processing (under 16 years old)",
      "severity": "high",
      "conditions": {
        "field": "age",
        "operator": "less_than",
        "value": 16
      },
      "remediation": "Verify parental consent before processing data of minors"
    },
    {
      "rule_id": "GDPR-008",
      "type": "format",
      "description": "Email communications require opt-out mechanism for marketing",
      "severity": "medium",
      "conditions": {
        "field": "marketing_consent",
        "operator": "equals",
        "value": true
      },
      "remediation": "Implement one-click unsubscribe in all marketing communications"
    },
    {
      "rule_id": "GDPR-009",
      "type": "access",
      "description": "All personal data processing must have documented lawful basis",
      "severity": "medium",
      "conditions": {
        "field": "lawful_basis",
        "operator": "exists"
      },
      "remediation": "Document lawful basis (consent, contract, legal obligation, vital interests, public task, legitimate interests) for all processing"
    },
    {
      "rule_id": "GDPR-010",
      "type": "encryption",
      "description": "Personal data in transit must be encrypted - checks for unencrypted transmission",
      "severity": "high",
      "conditions": {
        "field": "tls_enabled",
        "operator": "equals",
        "value": false
      },
      "remediation": "Enable TLS 1.2+ for all data transmission"
    }
  ]
}
